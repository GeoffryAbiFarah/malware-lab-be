import sys
import pefile

# 3 lists that can be used: pe_sections entry functions
# pe_sections is a list of tuple of size 4

# verify the number of arguments
argc = len(sys.argv)
if (argc != 2):
    print("Usage: python {0} <file>".format(sys.argv[0]))
    exit(1)

# load and parse PE file
file = sys.argv[1]
pe = pefile.PE(file)
#print("\n File: {} loaded!\n".format(file))

# information from file PE fields
#print("Information about the different PE sections:\n")
pe_sections = []
for section in pe.sections:
    pe_sections.append((section.Name, hex(section.VirtualAddress), hex(
        section.Misc_VirtualSize), section.SizeOfRawData))

# lists the DLLs and function calls
#print("\nDLL and function calls:")
entry = []
functions = []
for e in pe.DIRECTORY_ENTRY_IMPORT:
    entry.append(e.dll)
    for function in e.imports:
        functions.append(function.name)
